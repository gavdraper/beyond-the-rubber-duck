<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Transformation</title>
    <link rel="stylesheet" href="../main.css">
    <style>
        .header {
            text-align: center;
        }

        .title {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
        }

        .content {
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div class="slide">
        <div class="header">
            <h1 class="title">Story Transformation</h1>
            <p class="subtitle">From Vague Requirements to Production-Ready Stories</p>
        </div>

        <div class="content">
            <!-- Stage 1: Input -->
            <div class="stage input-stage active" id="stage1">
                <div class="story-card bad-story">
                    <div class="story-header">
                        <span class="story-icon">üìù</span>
                        <h3 class="story-title">Input: Poorly Written Story</h3>
                    </div>
                    <div class="story-content">
                        When new posts are created show a notification similar to twitter at the top of the screen to
                        other users, that notification should say "New Posts, Press . to load", When the user presses .
                        scroll to the top and refresh the posts

                        Priority: High
                    </div>

                </div>
            </div>

            <!-- Stage 2: Output -->
            <div class="stage output-stage" id="stage2">
                <div class="output-content">
                    <div
                        style="background: #e3f2fd; padding: 15px; border-radius: 6px; margin-bottom: 20px; border-left: 4px solid #2196f3;">
                        <strong>üéØ STORY 1/5</strong>
                    </div>

                    <div class="story-section">
                        <div class="section-title">Story</div>
                        <div class="section-content">
                            <strong>As a</strong> social media user, <br /><strong>I want</strong> to see a
                            notification when new posts are available <br /><strong>so that</strong> I can choose to
                            refresh my feed without missing recent content.
                        </div>
                    </div>

                    <div class="story-section">
                        <div class="section-title">Acceptance Criteria</div>
                        <div class="section-content">
                            <strong>Given</strong> new posts exist, <br />
                            <strong>when</strong> I'm viewing the feed, <br />
                            <strong>then</strong> a notification banner appears at the top
                            <br /><br />
                            <strong>Given</strong> the notification is shown, <br />
                            <strong>when</strong> I press ".", <br />
                            <strong>then</strong> the page scrolls to top and refreshes posts

                            <br />...

                        </div>
                    </div>

                    <div class="story-section">
                        <div class="section-title">Test Cases</div>
                        <div class="section-content">
                            <ul>
                                <li>Unit tests verify notification component renders correctly</li>
                                <li>Integration tests confirm WebSocket real-time updates work</li>
                                <li>E2E tests validate keyboard shortcut functionality</li>
                                <li>Performance tests ensure <2s notification display</li>
                                <li>...</li>
                            </ul>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn" onclick="goToPrevious()">
                <span>‚Üê</span>
                Back
            </button>
            <button class="nav-btn next" onclick="goToNext()">
                Next
                <span>‚Üí</span>
            </button>
        </div>
    </div>

    <script>
        function showStage(stageId) {
            // Hide all stages
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });

            // Show the specified stage
            setTimeout(() => {
                document.getElementById(stageId).classList.add('active');
            }, 300);
        }

        function showProcessing() {
            showStage('stage2');
        }

        function showOutput() {
            showStage('stage2');
        }

        function resetSlide() {
            showStage('stage1');
        }

        function goToPrevious() {
            const currentStage = document.querySelector('.stage.active');
            const currentId = currentStage.id;

            if (currentId === 'stage2') {
                showStage('stage1');
            } else if (currentId === 'stage1') {
                // Use the main navigation system for slide-to-slide navigation
                const previousUrl = './01-refinement.html';
                const separator = previousUrl.includes('?') ? '&' : '?';
                const urlWithParam = previousUrl + separator + 'skipAnimations=true';
                window.location.href = urlWithParam;
            }
        }

        function goToNext() {
            const currentStage = document.querySelector('.stage.active');
            const currentId = currentStage.id;

            if (currentId === 'stage1') {
                showOutput();
            } else if (currentId === 'stage2') {
                // Navigate to next slide in presentation
                window.location.href = '../04-coding/04-coding.html';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const cards = document.querySelectorAll('.story-card');

            cards.forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-5px) scale(1.02)';
                    this.style.boxShadow = '0 8px 24px rgba(0, 0, 0, 0.15)';
                });

                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0) scale(1)';
                    this.style.boxShadow = '0 4px 16px rgba(0, 0, 0, 0.1)';
                });
            });

            // Keyboard navigation
            document.addEventListener('keydown', function (e) {
                const currentStage = document.querySelector('.stage.active');
                const currentId = currentStage.id;

                if (e.key === 'ArrowRight' || e.key === ' ') {
                    e.preventDefault();
                    if (currentId === 'stage1') {
                        showOutput();
                    } else if (currentId === 'stage2') {
                        // Navigate to next slide when at final stage
                        window.location.href = '../04-coding/04-coding.html';
                    }
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    if (currentId === 'stage2') {
                        showStage('stage1');
                    } else if (currentId === 'stage1') {
                        // Navigate to previous slide when at first stage
                        const previousUrl = './01-refinement.html';
                        const separator = previousUrl.includes('?') ? '&' : '?';
                        const urlWithParam = previousUrl + separator + 'skipAnimations=true';
                        window.location.href = urlWithParam;
                    }
                } else if (e.key === 'Home') {
                    e.preventDefault();
                    resetSlide();
                }
            });
        });
    </script>
</body>

</html>